function N(A){const G={$near:(b,j)=>{const{latitude:k,longitude:w,radius:C}=j,E=b?.location?.latitude,f=b?.location?.longitude;if(typeof E!=="number"||typeof f!=="number")return!1;return H(E,f,k,w)<=C},$bbox:(b,j)=>{const{minLat:k,maxLat:w,minLng:C,maxLng:E}=j,f=b?.location?.latitude,z=b?.location?.longitude;if(typeof f!=="number"||typeof z!=="number")return!1;return f>=k&&f<=w&&z>=C&&z<=E}};function H(b,j,k,w){const C=(J)=>J*Math.PI/180,f=C(k-b),z=C(w-j),F=Math.sin(f/2)*Math.sin(f/2)+Math.cos(C(b))*Math.cos(C(k))*Math.sin(z/2)*Math.sin(z/2);return 6371*(2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F)))}const I=A.map;return A.map=async function(...b){const j=await I.call(this,...b);if(b.find((w)=>typeof w==="object")?.query)Object.assign(A.operators,G),console.log("Operadores geogr\xE1ficos inyectados:",A.operators);return j},A}export{N as withGeolocationOperators};
