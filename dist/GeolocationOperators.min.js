function M(z){const G={$near:(A,f)=>{const{latitude:j,longitude:k,radius:b}=f,E=A?.latitude,C=A?.longitude;if(typeof E!=="number"||typeof C!=="number")return!1;return H(E,C,j,k)<=b},$bbox:(A,f)=>{const{minLat:j,maxLat:k,minLng:b,maxLng:E}=f,C=A?.latitude,w=A?.longitude;if(typeof C!=="number"||typeof w!=="number")return!1;return C>=j&&C<=k&&w>=b&&w<=E}};function H(A,f,j,k){const b=(J)=>J*Math.PI/180,C=b(j-A),w=b(k-f),F=Math.sin(C/2)*Math.sin(C/2)+Math.cos(b(A))*Math.cos(b(j))*Math.sin(w/2)*Math.sin(w/2);return 6371*(2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F)))}const I=z.map;return z.map=async function(...A){const f=await I.call(this,...A);if(A.find((k)=>typeof k==="object")?.query)Object.assign(z.operators,G),console.log("Operadores geogr\xE1ficos inyectados:",z.operators);return f},z}export{M as withGeolocationOperators};
